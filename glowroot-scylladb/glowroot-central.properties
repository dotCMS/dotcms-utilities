# Glowroot Central Configuration
# Optimized for high-performance server with ScyllaDB backend

# Cassandra/ScyllaDB connection settings
cassandra.contactPoints=127.0.0.1:9042
cassandra.keyspace=glowroot
cassandra.consistency.read=ONE
cassandra.consistency.write=ONE

# Connection pool settings - Increased for high throughput
cassandra.poolTimeoutMillis=60000
cassandra.readTimeoutMillis=60000
cassandra.connectTimeoutMillis=30000

# High-throughput connection settings
cassandra.maxRequestsPerConnection=32768
cassandra.coreConnectionsPerHost=16
cassandra.maxConnectionsPerHost=64
cassandra.heartbeatIntervalSeconds=30

# Request throttling settings - Significantly increased
cassandra.maxRequestsPerSecond=50000
cassandra.maxQueueSize=50000
cassandra.throttlingDelay=1

# Advanced connection tuning
cassandra.requestTimeout=30000
cassandra.connectionInitTimeout=15000
cassandra.schemaAgreementTimeout=30000

# Keyspace creation settings (for initial setup) - Single node configuration
cassandra.keyspaceReplication={'class': 'SimpleStrategy', 'replication_factor': 1}

# Force consistency levels for single node (override any defaults)
cassandra.consistency.read=ONE
cassandra.consistency.write=ONE
cassandra.consistency.serial=LOCAL_SERIAL
cassandra.localDatacenter=datacenter1

# Web UI settings
ui.port=4000
ui.bind.address=0.0.0.0
ui.https=false

# gRPC settings for agent connections
grpc.port=8181
grpc.bind.address=0.0.0.0

# Data retention settings (adjust based on your monitoring needs)
# Aggregate data retention
aggregate.expiration.hours=2160  # 90 days

# Trace data retention
trace.expiration.hours=336       # 14 days

# Gauge data retention
gauge.expiration.hours=2160      # 90 days

# Synthetic monitor data retention
syntheticMonitor.expiration.hours=2160  # 90 days

# Incident data retention
incident.expiration.hours=8760   # 1 year

# Performance settings - Optimized for high load
aggregate.queryLimit=1000
trace.queryLimit=1000

# Central collector settings - Increased capacity
central.display.traceCount=100000
central.display.aggregateCount=100000

# Batch processing settings
central.maxTraceBatchSize=1000
central.maxAggregateBatchSize=1000
central.batchProcessingThreads=8

# JVM heap dump settings
jvm.heapDump.path=/var/lib/glowroot-central/heap-dumps

# Logging settings
logging.level=INFO
logging.file=/var/lib/glowroot-central/logs/glowroot-central.log
logging.file.maxSize=100MB
logging.file.maxHistory=10

# LDAP authentication (uncomment and configure if needed)
# ldap.url=ldap://localhost:389
# ldap.username=
# ldap.password=
# ldap.userSearchBase=ou=users,dc=example,dc=com
# ldap.userSearchFilter=(uid={0})
# ldap.groupSearchBase=ou=groups,dc=example,dc=com
# ldap.groupSearchFilter=(member={0})

# Email settings for alerts (uncomment and configure if needed)
# smtp.host=smtp.example.com
# smtp.port=587
# smtp.username=
# smtp.password=
# smtp.from.address=glowroot@example.com
# smtp.from.display.name=Glowroot

# Advanced ScyllaDB tuning
cassandra.gcGraceSeconds=864000  # 10 days
cassandra.maxRequestsPerConnection=32768
cassandra.coreConnectionsPerHost=8
cassandra.maxConnectionsPerHost=32

